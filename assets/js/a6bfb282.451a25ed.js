"use strict";(globalThis.webpackChunk_indeepvision_idvision_docs=globalThis.webpackChunk_indeepvision_idvision_docs||[]).push([[1188],{2247:(e,n,i)=>{i.d(n,{xA:()=>m,yg:()=>g});var a=i(4041);function t(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function s(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?s(Object(i),!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function r(e,n){if(null==e)return{};var i,a,t=function(e,n){if(null==e)return{};var i,a,t={},s=Object.keys(e);for(a=0;a<s.length;a++)i=s[a],n.indexOf(i)>=0||(t[i]=e[i]);return t}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)i=s[a],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}var o=a.createContext({}),p=function(e){var n=a.useContext(o),i=n;return e&&(i="function"==typeof e?e(n):l(l({},n),e)),i},m=function(e){var n=p(e.components);return a.createElement(o.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var i=e.components,t=e.mdxType,s=e.originalType,o=e.parentName,m=r(e,["components","mdxType","originalType","parentName"]),u=p(i),c=t,g=u["".concat(o,".").concat(c)]||u[c]||d[c]||s;return i?a.createElement(g,l(l({ref:n},m),{},{components:i})):a.createElement(g,l({ref:n},m))}));function g(e,n){var i=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var s=i.length,l=new Array(s);l[0]=c;var r={};for(var o in n)hasOwnProperty.call(n,o)&&(r[o]=n[o]);r.originalType=e,r[u]="string"==typeof e?e:t,l[1]=r;for(var p=2;p<s;p++)l[p]=i[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,i)}c.displayName="MDXCreateElement"},9357:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>p});var a=i(9575),t=(i(4041),i(2247));const s={sidebar_position:2},l="Classes VisionElement",r={unversionedId:"software/computer-vision/vision-elements/classes-vision-element",id:"software/computer-vision/vision-elements/classes-vision-element",title:"Classes VisionElement",description:"Prop\xf2sit dels tipus VisionElement",source:"@site/docs/software/computer-vision/vision-elements/classes-vision-element.md",sourceDirName:"software/computer-vision/vision-elements",slug:"/software/computer-vision/vision-elements/classes-vision-element",permalink:"/dev/docs/software/computer-vision/vision-elements/classes-vision-element",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"computerVision",previous:{title:"Naming",permalink:"/dev/docs/software/computer-vision/vision-elements/naming"},next:{title:"Serialitzaci\xf3",permalink:"/dev/docs/software/computer-vision/vision-elements/serialitzacio"}},o={},p=[{value:"Prop\xf2sit dels tipus VisionElement",id:"prop\xf2sit-dels-tipus-visionelement",level:2},{value:"Qu\xe8 pot ser un Vision Element",id:"qu\xe8-pot-ser-un-vision-element",level:2},{value:"Value i props",id:"value-i-props",level:2},{value:"M\xe8todes classe base",id:"m\xe8todes-classe-base",level:2},{value:"M\xe8todes classes derivades",id:"m\xe8todes-classes-derivades",level:2},{value:"Quina classe utilitzar a la implementaci\xf3",id:"quina-classe-utilitzar-a-la-implementaci\xf3",level:2},{value:"Difer\xe8ncia <code>Shape2d</code> i <code>Path2d</code>",id:"difer\xe8ncia-shape2d-i-path2d",level:2},{value:"Serialitzaci\xf3",id:"serialitzaci\xf3",level:2},{value:"Flat",id:"flat",level:3},{value:"JSON",id:"json",level:3}],m={toc:p},u="wrapper";function d({components:e,...n}){return(0,t.yg)(u,(0,a.A)({},m,n,{components:e,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"classes-visionelement"},"Classes VisionElement"),(0,t.yg)("h2",{id:"prop\xf2sit-dels-tipus-visionelement"},"Prop\xf2sit dels tipus VisionElement"),(0,t.yg)("p",null,"Qu\xe8 permeten els tipus VisionElement?"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Tracking amb identificador \xfanic (ID)."),(0,t.yg)("li",{parentName:"ul"},"Possibilitat de fer aniuament d'objectes (parent/children)."),(0,t.yg)("li",{parentName:"ul"},"Serialitzaci\xf3 (guardar/obrir objectes des de disc)."),(0,t.yg)("li",{parentName:"ul"},"Propietats de visualitzaci\xf3 (colors, gruix de l\xednia, etc)."),(0,t.yg)("li",{parentName:"ul"},"Tipus base \xfanic ",(0,t.yg)("inlineCode",{parentName:"li"},"VisionElement")," per manejar els objectes (polimorfisme). El problema \xe9s que no podrem fer ",(0,t.yg)("inlineCode",{parentName:"li"},"std::vector<VisionElement>"),".")),(0,t.yg)("h2",{id:"qu\xe8-pot-ser-un-vision-element"},"Qu\xe8 pot ser un Vision Element"),(0,t.yg)("p",null,"Un tipus ha de ser un Vision Element si es compleix alguna d'aquestes dues condicions:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"T\xe9 sentit mostrar-lo sobre una imatge."),(0,t.yg)("li",{parentName:"ul"},"O representa un resultat d'una operaci\xf3 de visi\xf3 que voldrem guardar o analitzar, i no hi ha algun dels Vision Elements actuals que el pugui representar per si sol.")),(0,t.yg)("p",null,"Sempre s'ha d'intentar que el VisionElement representi la m\xednima informaci\xf3 possible, la m\xednima unitat indivisible. Per exemple, pel Pattern Matching segurament ser\xe0 millor crear el VisionElement ",(0,t.yg)("inlineCode",{parentName:"p"},"Keypoint2d"),", i no crear un VisionElement que contingui una llista de keypoints. La m\xednima unitat indivisible \xe9s el ",(0,t.yg)("inlineCode",{parentName:"p"},"Keypoint2d"),"."),(0,t.yg)("p",null,"Tipus que ",(0,t.yg)("strong",{parentName:"p"},"no")," han de ser Vision Elements:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Primitives."),(0,t.yg)("li",{parentName:"ul"},"Matrius."),(0,t.yg)("li",{parentName:"ul"},"Objectes de configuraci\xf3.")),(0,t.yg)("p",null,"Justificaci\xf3 de tipus que s\xf3n Vision Elements per\xf2 estan a l'extrem:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"Tensor"),": el fem Vision Element perqu\xe8 \xe9s el resultat d'una operaci\xf3 de visi\xf3 (xarxa neuronal) i necessitem la funcionalitat de guardar, aniuar i acc\xe9s des de classe base ",(0,t.yg)("inlineCode",{parentName:"li"},"VisionElement"),"."),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"CameraCalibration")," (antic ",(0,t.yg)("inlineCode",{parentName:"li"},"DistortionData"),"): \xe9s un resultat de visi\xf3.")),(0,t.yg)("h2",{id:"value-i-props"},"Value i props"),(0,t.yg)("p",null,"Un VisionElement est\xe0 format per ",(0,t.yg)("strong",{parentName:"p"},"basics")," + ",(0,t.yg)("strong",{parentName:"p"},"value")," + ",(0,t.yg)("strong",{parentName:"p"},"props"),"."),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("strong",{parentName:"li"},"Basics"),": s\xf3n les propietats comunes que comparteixen tots els VisionElements (",(0,t.yg)("inlineCode",{parentName:"li"},"id"),", ",(0,t.yg)("inlineCode",{parentName:"li"},"type"),", ",(0,t.yg)("inlineCode",{parentName:"li"},"parent_id"),", ",(0,t.yg)("inlineCode",{parentName:"li"},"name"),", ",(0,t.yg)("inlineCode",{parentName:"li"},"description"),")."),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("strong",{parentName:"li"},"Value"),": serveix com a emmagatzematge dels valors intr\xednsecs de l'element. Aquests s\xf3n els valors que serveixen per fer operacions amb l'element, siguin geom\xe8triques o de qualsevol altre tipus. Per exemple, d'un punt els valors intr\xednsecs s\xf3n ",(0,t.yg)("inlineCode",{parentName:"li"},"{x, y}"),"."),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("strong",{parentName:"li"},"Props"),": serveixen per propietats que no s\xf3n intr\xednseques de l'element, sin\xf3 que s\xf3n complements, per exemple per pintar l'element en una pantalla.")),(0,t.yg)("p",null,"Els VisionElements s\xf3n smart pointers de la classe ",(0,t.yg)("inlineCode",{parentName:"p"},"IVisionElement"),", i s\xf3n els elements que exposem a la interf\xedcie p\xfablica. Exposem shared pointers de ",(0,t.yg)("inlineCode",{parentName:"p"},"IVisionElement")," a la interf\xedcie p\xfablica degut a la vinculaci\xf3 que tenim tant des de OneVision com des dels scripts de runtime amb el llenguatge TypeScript, en el qual els objectes s\xf3n m\xe9s o menys equivalents als shared pointers. (Realment els shared pointers s\xf3n millors que el garbage collector de JavaScript)."),(0,t.yg)("h2",{id:"m\xe8todes-classe-base"},"M\xe8todes classe base"),(0,t.yg)("p",null,"Quan parlem de m\xe8todes, s\xf3n funcions que pertanyen a una classe (funcions membre). Les funcions lliures (o stand-alone) no es poden dir m\xe8tode."),(0,t.yg)("p",null,"El m\xe8tode ",(0,t.yg)("inlineCode",{parentName:"p"},"clone")," \xe9s un m\xe8tode abstracte com\xfa per tots els Vision Elements, perqu\xe8 \xe9s patr\xf3 habitual en implementacions de classes amb polimorfisme. L'objectiu del ",(0,t.yg)("inlineCode",{parentName:"p"},"clone")," \xe9s poder generar una c\xf2pia d'aquella inst\xe0ncia, sigui cridant el ",(0,t.yg)("inlineCode",{parentName:"p"},"clone")," des de la classe base com des de la classe derivada."),(0,t.yg)("h2",{id:"m\xe8todes-classes-derivades"},"M\xe8todes classes derivades"),(0,t.yg)("p",null,"Per a tots els VisionElements, \xe9s preferible evitar m\xe8todes get/set i fer p\xfabliques les variables del value directament. Aix\xf2 \xe9s perqu\xe8 a nivell d'usuari \xe9s m\xe9s pr\xe0ctic fer ",(0,t.yg)("inlineCode",{parentName:"p"},"point.x = 3")," que ",(0,t.yg)("inlineCode",{parentName:"p"},"point.setX(3)"),". I tamb\xe9 perqu\xe8 estalvia codi."),(0,t.yg)("p",null,"Actualment les classes ",(0,t.yg)("inlineCode",{parentName:"p"},"Shape")," i ",(0,t.yg)("inlineCode",{parentName:"p"},"Path")," funcionen amb get/set per una limitaci\xf3 del Node-addon API, que no permet implementar els getters i setters de forma niuada per elements d'una llista. Si no hi hagu\xe9s aquesta limitaci\xf3, tamb\xe9 exposar\xedem directament els vectors de punts tant pel ",(0,t.yg)("inlineCode",{parentName:"p"},"Shape")," com pel ",(0,t.yg)("inlineCode",{parentName:"p"},"Path"),"."),(0,t.yg)("admonition",{type:"note"},(0,t.yg)("p",{parentName:"admonition"},"Quins m\xe8todes poden formar part de les classes derivades de VisionElement? No hi volem funcions que requereixin molt de processament, nom\xe9s consultes sobre la informaci\xf3 de la inst\xe0ncia.")),(0,t.yg)("h2",{id:"quina-classe-utilitzar-a-la-implementaci\xf3"},"Quina classe utilitzar a la implementaci\xf3"),(0,t.yg)("p",null,"Les funcions d'implementaci\xf3 han d'utilitzar els elements m\xe9s b\xe0sics possible, que normalment s\xf3n els value. Per exemple, per moure un punt, l'element m\xe9s b\xe0sic \xe9s el value (no utilitzarem directament ",(0,t.yg)("inlineCode",{parentName:"p"},"x")," i ",(0,t.yg)("inlineCode",{parentName:"p"},"y"),"). En canvi, per convertir un element a JSON l'element m\xe9s b\xe0sic \xe9s directament el ",(0,t.yg)("inlineCode",{parentName:"p"},"VisionElement"),"."),(0,t.yg)("h2",{id:"difer\xe8ncia-shape2d-i-path2d"},"Difer\xe8ncia ",(0,t.yg)("inlineCode",{parentName:"h2"},"Shape2d")," i ",(0,t.yg)("inlineCode",{parentName:"h2"},"Path2d")),(0,t.yg)("p",null,"Els paths defineixen una traject\xf2ria. Els shapes defineixen una \xe0rea."),(0,t.yg)("p",null,"Els shapes, definint una \xe0rea, poden tenir forats."),(0,t.yg)("h2",{id:"serialitzaci\xf3"},"Serialitzaci\xf3"),(0,t.yg)("h3",{id:"flat"},"Flat"),(0,t.yg)("p",null,"L'objectiu dels elements flat \xe9s representar exactament la mateixa informaci\xf3 que els VisionElement natius, per\xf2 en forma de propietats accessibles/p\xfabliques. O sigui que exposen el valor de forma p\xfablica, no amagat dintre d'una classe."),(0,t.yg)("p",null,"Amb els flat no es podran fer operacions, perqu\xe8 no s\xf3n una inst\xe0ncia d'una classe, per\xf2 s\xed que ens permeten enviar dades."),(0,t.yg)("p",null,"Nom\xe9s es permeten els tipus: ",(0,t.yg)("inlineCode",{parentName:"p"},"object"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"list"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"number"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"boolean"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"string"),"."),(0,t.yg)("admonition",{type:"note"},(0,t.yg)("p",{parentName:"admonition"},"No tenim clar si volem que els flat es mantinguin dintre de la llibreria, si s\xf3n prescindibles o superflus.")),(0,t.yg)("h3",{id:"json"},"JSON"),(0,t.yg)("p",null,"La conversi\xf3 a JSON s'ha de fer de manera que si des de TypeScript fem:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-typescript"},"flat = ve_to_flat(ve);\nstr1 = JSON.stringify(flat);\nstr2 = ve_to_json(ve);\n// str1 i str2 han de ser el mateix\n")))}d.isMDXComponent=!0}}]);