"use strict";(globalThis.webpackChunk_indeepvision_idvision_docs=globalThis.webpackChunk_indeepvision_idvision_docs||[]).push([[2934],{111:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/imatge-domo-78f4c17502890e142b777b193570ba3d.png"},209:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/pixels-gos-688e36612db4341c2dcc1a8f3ff10a92.png"},904:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/diagrama-cnn-c027bdbe550a1bd44c521d5262182ad8.png"},1234:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/imatges-masia-artesana-c1e4fc5fd90f1aa4afccaded8562ccbe.png"},1826:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/inspeccio-peca-metalica-1af8af99d509795dd40a72a9e5381b92.png"},2247:(e,a,n)=>{n.d(a,{xA:()=>p,yg:()=>g});var i=n(4041);function l(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function s(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,i)}return n}function t(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?s(Object(n),!0).forEach((function(a){l(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function r(e,a){if(null==e)return{};var n,i,l=function(e,a){if(null==e)return{};var n,i,l={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],a.indexOf(n)>=0||(l[n]=e[n]);return l}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=i.createContext({}),c=function(e){var a=i.useContext(o),n=a;return e&&(n="function"==typeof e?e(a):t(t({},a),e)),n},p=function(e){var a=c(e.components);return i.createElement(o.Provider,{value:a},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return i.createElement(i.Fragment,{},a)}},d=i.forwardRef((function(e,a){var n=e.components,l=e.mdxType,s=e.originalType,o=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),m=c(n),d=l,g=m["".concat(o,".").concat(d)]||m[d]||u[d]||s;return n?i.createElement(g,t(t({ref:a},p),{},{components:n})):i.createElement(g,t({ref:a},p))}));function g(e,a){var n=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var s=n.length,t=new Array(s);t[0]=d;var r={};for(var o in a)hasOwnProperty.call(a,o)&&(r[o]=a[o]);r.originalType=e,r[m]="string"==typeof e?e:l,t[1]=r;for(var c=2;c<s;c++)t[c]=n[c];return i.createElement.apply(null,t)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3257:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/imatges-tecnotor-11aa087fb4dee2442aaac299a3d2aceb.png"},3314:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/gos-canvi-orelles-fdbf49f0cdb97ac406907beacb53c343.png"},3349:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/trobar-orelles-gos-e73bdf3b470fa0cbbfc3f6a9799b7ec6.png"},4910:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/pregunta-on-esta-punt-negre-da14f2598ecd87efc5fd09de03cc2df6.png"},5333:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/grafic-potencia-temperatura-904baae407efe3c373b8f1f8a6c3871a.png"},5527:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/inspeccio-manual-fabriques-f77d9954a2ad949f63297d9130dbc9c0.png"},5729:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/mnist-455aa4d8e7cc74d8a22a89fdaa560353.png"},6027:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/imatges-traktech-da17a8bb47834e6cbd19f218c5a7ee9c.png"},6331:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/neurona-potencia-temperatura-0f13e69732989b6fa3854c4e20fdb0e7.png"},6726:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var i=n(9575),l=(n(4041),n(2247));const s={sidebar_position:2},t="Deep learning aplicat a la visi\xf3",r={unversionedId:"projectes/onboarding/formacio/deep-learning-visio",id:"projectes/onboarding/formacio/deep-learning-visio",title:"Deep learning aplicat a la visi\xf3",description:"A continuaci\xf3 es desenvolupa el contingut de la formaci\xf3, d'aproximadament 90 min, pensada per a enginyers de visi\xf3 i gestors de comptes. L'objectiu \xe9s entendre les limitacions de la visi\xf3 cl\xe0ssica, com funciona el deep learning i per qu\xe8 \xe9s la soluci\xf3 m\xe9s adequada per a la majoria de projectes de visi\xf3 industrial actuals.",source:"@site/docs/projectes/onboarding/formacio/deep-learning-visio.md",sourceDirName:"projectes/onboarding/formacio",slug:"/projectes/onboarding/formacio/deep-learning-visio",permalink:"/dev/docs/projectes/onboarding/formacio/deep-learning-visio",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"onboardingProjectes",previous:{title:"Hardware de visi\xf3 artificial",permalink:"/dev/docs/projectes/onboarding/formacio/hardware-visio-artificial"},next:{title:"Electricitat industrial b\xe0sica",permalink:"/dev/docs/projectes/onboarding/formacio/electricitat-industrial"}},o={},c=[{value:"Visi\xf3 artificial cl\xe0ssica",id:"visi\xf3-artificial-cl\xe0ssica",level:2},{value:"Com funcionen els algoritmes tradicionals",id:"com-funcionen-els-algoritmes-tradicionals",level:3},{value:"L&#39;exemple del gos",id:"lexemple-del-gos",level:4},{value:"Limitacions de la visi\xf3 cl\xe0ssica",id:"limitacions-de-la-visi\xf3-cl\xe0ssica",level:3},{value:"Avaluaci\xf3",id:"avaluaci\xf3",level:3},{value:"Qu\xe8 \xe9s el deep learning",id:"qu\xe8-\xe9s-el-deep-learning",level:2},{value:"Aclaraci\xf3: IA, machine learning i deep learning",id:"aclaraci\xf3-ia-machine-learning-i-deep-learning",level:3},{value:"El data driven approach",id:"el-data-driven-approach",level:3},{value:"Xarxes neuronals",id:"xarxes-neuronals",level:3},{value:"Un exemple senzill: aprendre a predir la pot\xe8ncia d&#39;un sistema de calefacci\xf3",id:"un-exemple-senzill-aprendre-a-predir-la-pot\xe8ncia-dun-sistema-de-calefacci\xf3",level:4},{value:"Machine learning i deep learning reals",id:"machine-learning-i-deep-learning-reals",level:3},{value:"Deep learning: xarxes neuronals grans per a qualsevol problema",id:"deep-learning-xarxes-neuronals-grans-per-a-qualsevol-problema",level:4},{value:"Avaluaci\xf3",id:"avaluaci\xf3-1",level:3},{value:"Exemples reals",id:"exemples-reals",level:2},{value:"Exemples amb deep learning",id:"exemples-amb-deep-learning",level:3},{value:"Detecci\xf3 de defectes en pellets de pl\xe0stic",id:"detecci\xf3-de-defectes-en-pellets-de-pl\xe0stic",level:4},{value:"Detecci\xf3 de l&#39;orientaci\xf3 d&#39;una ampolla",id:"detecci\xf3-de-lorientaci\xf3-duna-ampolla",level:4},{value:"Comptar mandonguilles",id:"comptar-mandonguilles",level:4},{value:"Exemples amb visi\xf3 tradicional",id:"exemples-amb-visi\xf3-tradicional",level:3},{value:"Mesura de peces (metrologia)",id:"mesura-de-peces-metrologia",level:4},{value:"Matching de patrons",id:"matching-de-patrons",level:4},{value:"Avaluaci\xf3",id:"avaluaci\xf3-2",level:3},{value:"El futur: el cervell \xe9s una m\xe0quina incre\xefble, per\xf2 ens estem acostant",id:"el-futur-el-cervell-\xe9s-una-m\xe0quina-incre\xefble-per\xf2-ens-estem-acostant",level:2},{value:"Resum: quan usar deep learning i quan visi\xf3 cl\xe0ssica",id:"resum-quan-usar-deep-learning-i-quan-visi\xf3-cl\xe0ssica",level:2}],p={toc:c},m="wrapper";function u({components:e,...a}){return(0,l.yg)(m,(0,i.A)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"deep-learning-aplicat-a-la-visi\xf3"},"Deep learning aplicat a la visi\xf3"),(0,l.yg)("p",null,"A continuaci\xf3 es desenvolupa el contingut de la formaci\xf3, d'aproximadament 90 min, pensada per a enginyers de visi\xf3 i gestors de comptes. L'objectiu \xe9s entendre les limitacions de la visi\xf3 cl\xe0ssica, com funciona el deep learning i per qu\xe8 \xe9s la soluci\xf3 m\xe9s adequada per a la majoria de projectes de visi\xf3 industrial actuals."),(0,l.yg)("admonition",{type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"Degut a l'\xfas continuat que en fem, a ID Vision escrivim ",(0,l.yg)("strong",{parentName:"p"},"deep learning")," sense maj\xfascules a les primeres lletres, i fem servir ",(0,l.yg)("strong",{parentName:"p"},"DL")," com a acr\xf2nim. El mateix fem amb ",(0,l.yg)("strong",{parentName:"p"},"machine learning")," (ML) i ",(0,l.yg)("strong",{parentName:"p"},"intel\xb7lig\xe8ncia artificial")," (IA).")),(0,l.yg)("h2",{id:"visi\xf3-artificial-cl\xe0ssica"},"Visi\xf3 artificial cl\xe0ssica"),(0,l.yg)("p",null,"La visi\xf3 artificial porta d\xe8cades aplicant-se en entorns industrials. Fa anys que \xe9s una tecnologia madura i en molts casos continua sent la millor opci\xf3."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(8137).A}),(0,l.yg)("figcaption",null,"Sistema de visi\xf3 Autovision II (Automatrix, 1981).")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(1826).A}),(0,l.yg)("figcaption",null,"Exemple d'inspecci\xf3 de pe\xe7a met\xe0l\xb7lica amb visi\xf3 cl\xe0ssica (no deep learning).")),(0,l.yg)("p",null,"La visi\xf3 cl\xe0ssica funciona molt b\xe9 en casos com la lectura de codis de barres, la detecci\xf3 de peces invariants o la mesura de dimensions. Es basa en algoritmes espec\xedfics amb condicions dissenyades ad hoc per a cada problema."),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"No s'ha d'infravalorar la visi\xf3 cl\xe0ssica. Per algunes aplicacions concretes funciona millor que els algoritmes de deep learning, especialment en tasques de metrologia d'alta precisi\xf3.")),(0,l.yg)("h3",{id:"com-funcionen-els-algoritmes-tradicionals"},"Com funcionen els algoritmes tradicionals"),(0,l.yg)("p",null,"Els algoritmes de visi\xf3 cl\xe0ssica es basen en definir regles i passos expl\xedcits:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Si passa A \u2192 Fem B"),(0,l.yg)("li",{parentName:"ul"},"Si detecto p\xedxels de valors foscos agrupats \u2192 equival a \xe0rea de defecte"),(0,l.yg)("li",{parentName:"ul"},"Si detecto un canvi de contrast en una direcci\xf3 \u2192 \xe9s un edge (aresta)")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(7643).A}),(0,l.yg)("figcaption",null,"Il\xb7lustraci\xf3 d'un algoritme.")),(0,l.yg)("p",null,"Una persona amb coneixement dels algoritmes ha d'especificar que passa en ",(0,l.yg)("strong",{parentName:"p"},"tots")," els possibles escenaris. Aix\xf2 presenta tres problemes fonamentals:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\xc9s complex con\xe8ixer tota la variabilitat d'un problema real"),(0,l.yg)("li",{parentName:"ul"},"\xc9s dif\xedcil discriminar elements visuals entre ells"),(0,l.yg)("li",{parentName:"ul"},"Qualsevol canvi pot produir comportaments inesperats que s'han de preveure i programar")),(0,l.yg)("h4",{id:"lexemple-del-gos"},"L'exemple del gos"),(0,l.yg)("p",null,"Una imatge en escala de grisos \xe9s una matriu de p\xedxels (una imatge color s\xf3n 3 matrius RGB). Cada p\xedxel cont\xe9 informaci\xf3 d'il\xb7luminaci\xf3 d'aquell punt: m\xe9s clar vol dir m\xe9s llum i, per tant, valors num\xe8rics m\xe9s alts."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(209).A}),(0,l.yg)("figcaption",null,"Qu\xe8 \xe9s realment la imatge d'un gos?")),(0,l.yg)("p",null,"Existeixen molts tipus d'algoritmes per detectar coses sobre imatges: l\xednies, taques, punts d'inter\xe8s. Per\xf2 la majoria d'aquests algoritmes es basen en propietats locals dels p\xedxels. ",(0,l.yg)("strong",{parentName:"p"},"El coneixement sobre el que es busca l'ha d'aportar l'enginyer de visi\xf3.")),(0,l.yg)("p",null,'Per exemple, per trobar un gos, podr\xedem intentar crear regles per trobar les seves orelles: busquem l\xednies verticals i horitzontals, busquem taques fosques o clares, busquem "punts caracter\xedstics"..'),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(3349).A}),(0,l.yg)("figcaption",null,"Possible algoritme per trobar les orelles d'un gos.")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Per\xf2 tot pot canviar de cop!")," El mateix gos en una pose diferent, amb una altra il\xb7luminaci\xf3, o en un altre context, pot fer fallir completament les regles que hav\xedem definit."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(3314).A}),(0,l.yg)("figcaption",null,"On s\xf3n ara les orelles si les busquem amb visi\xf3 cl\xe0ssica?")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(8924).A}),(0,l.yg)("figcaption",null,"Aix\xf2 s\xf3n gossos?")),(0,l.yg)("p",null,"Aquests exemples il\xb7lustren el problema fonamental: el que \xe9s trivial per a un hum\xe0 (recon\xe8ixer un gos) \xe9s extremadament complex de codificar en regles."),(0,l.yg)("admonition",{type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"El deep learning \xe9s molt fort en posicionar i classificar regions d'una imatge. Per exemple, tobar les orelles del gos (i de qualsevol gos!) pel DL \xe9s un problema relativament senzill. A ID Vision aprofitem aquesta caracter\xedstica per ajudar-nos a localitzar elements, que a vegades despr\xe9s post-processem amb visi\xf3 cl\xe0ssica.")),(0,l.yg)("h3",{id:"limitacions-de-la-visi\xf3-cl\xe0ssica"},"Limitacions de la visi\xf3 cl\xe0ssica"),(0,l.yg)("p",null,"La visi\xf3 cl\xe0ssica ",(0,l.yg)("strong",{parentName:"p"},"pot funcionar")," en condicions molt concretes: elements a detectar molt clars i ben definits, condicions de l'entorn estables, producte sempre el mateix, i defectes de formes molt similars."),(0,l.yg)("p",null,"A la pr\xe0ctica, per\xf2, la visi\xf3 cl\xe0ssica presenta problemes greus en escenaris reals:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"T\xe9 molt ",(0,l.yg)("strong",{parentName:"li"},"fals rebuig")," (rebutja producte bo)"),(0,l.yg)("li",{parentName:"ul"},"\xc9s ",(0,l.yg)("strong",{parentName:"li"},"complexa de mantenir"),": cal personal format que estigui molt a sobre les m\xe0quines"),(0,l.yg)("li",{parentName:"ul"},"En general, les tasques industrials no tenen defectes similars, els productes canvien sovint i els elements a detectar no s\xf3n evidents")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Tasques que s\xf3n molt f\xe0cils per a un hum\xe0, son extremadament complexes per a una m\xe0quina.")),(0,l.yg)("p",null,"La realitat en moltes f\xe0briques acaba sent la inspecci\xf3 manual, amb tots els costos i limitacions que aix\xf2 comporta."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(5527).A}),(0,l.yg)("figcaption",null,"Inspeccions complexes encara es fan molt sovint per persones.")),(0,l.yg)("h3",{id:"avaluaci\xf3"},"Avaluaci\xf3"),(0,l.yg)("admonition",{title:"Respon les seg\xfcents preguntes",type:"info"},(0,l.yg)("ol",{parentName:"admonition"},(0,l.yg)("li",{parentName:"ol"},"Amb l'exemple del gos, explica per qu\xe8 definir regles per trobar orelles no \xe9s un bon enfocament per recon\xe8ixer gossos. Se t'acudeix algun enfoc alternatiu?"),(0,l.yg)("li",{parentName:"ol"},"Un client vol detectar defectes en superf\xedcies de fusta natural, on les vetes i els nusos varien molt entre peces. Per qu\xe8 un enfocament de visi\xf3 cl\xe0ssica probablement fallaria en aquest cas?"),(0,l.yg)("li",{parentName:"ol"},'Qu\xe8 vol dir que la visi\xf3 cl\xe0ssica t\xe9 molt "fals rebuig"? Per qu\xe8 \xe9s un problema greu en un entorn de producci\xf3 industrial?'))),(0,l.yg)("h2",{id:"qu\xe8-\xe9s-el-deep-learning"},"Qu\xe8 \xe9s el deep learning"),(0,l.yg)("h3",{id:"aclaraci\xf3-ia-machine-learning-i-deep-learning"},"Aclaraci\xf3: IA, machine learning i deep learning"),(0,l.yg)("p",null,"\xc9s important aclarir la terminologia, ja que sovint s'utilitzen indistintament de forma incorrecta:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Intel\xb7lig\xe8ncia artificial (IA):")," camp ampli que inclou qualsevol sistema que imiti la intel\xb7lig\xe8ncia humana. Existeix des dels anys 50. Segons la majoria de convencions ",(0,l.yg)("strong",{parentName:"li"},"inclou la visi\xf3 artificial cl\xe0ssica.")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Machine learning (ML):")," subcamp de la IA on els sistemes aprenen de les dades sense ser programats expl\xedcitament."),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Deep learning (DL):")," subcamp del machine learning basat en xarxes neuronals profundes. \xc9s el que emprem nosaltres.")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(9570).A}),(0,l.yg)("figcaption",null,"Evoluci\xf3 en el temps del camp de la intel\xb7lig\xe8ncia artificial.")),(0,l.yg)("p",null,"Els conceptes matem\xe0tics que s'utilitzen ara s'inventen el ",(0,l.yg)("strong",{parentName:"p"},"1957"),". Tot i que el boom comercial no arriba fins al 2019\u20132020 (especialment a Espanya), l'acad\xe8mia descobreix el potencial del deep learning el ",(0,l.yg)("strong",{parentName:"p"},"2012")," i s'hi bolca massivament."),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},'Quan un client parla d\'"intel\xb7lig\xe8ncia artificial" o "IA", probablement es refereix al deep learning. Quan nosaltres parlem de DL, parlem d\'una tecnologia molt concreta i ben definida.')),(0,l.yg)("h3",{id:"el-data-driven-approach"},"El data driven approach"),(0,l.yg)("p",null,"La difer\xe8ncia fonamental respecte a la visi\xf3 cl\xe0ssica \xe9s el ",(0,l.yg)("strong",{parentName:"p"},"canvi de paradigma"),": en lloc d'intentar crear una soluci\xf3 per a un problema concret definint regles, creem sistemes capa\xe7os d'aprendre per si mateixos."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(7742).A}),(0,l.yg)("figcaption",null,"Exemple de classificaci\xf3 amb deep learning.")),(0,l.yg)("p",null,"El proc\xe9s \xe9s el seg\xfcent:"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"Creem una m\xe0quina (xarxa neuronal) que aprengui a imitar la forma de funcionar del cervell"),(0,l.yg)("li",{parentName:"ol"},"Li proporcionem suficients dades perqu\xe8 aprengui"),(0,l.yg)("li",{parentName:"ol"},"Codifiquem les imatges i els resultats que volem d'una manera que la m\xe0quina entengui"),(0,l.yg)("li",{parentName:"ol"},'Obtenim una m\xe0quina "universal" que pot resoldre nous problemes sense reprogramaci\xf3')),(0,l.yg)("p",null,"El resultat \xe9s una eina gen\xe8rica i flexible, no un programa espec\xedfic per a cada cas."),(0,l.yg)("h3",{id:"xarxes-neuronals"},"Xarxes neuronals"),(0,l.yg)("p",null,"La inspiraci\xf3 del deep learning ve de la biologia. El cervell hum\xe0 processa informaci\xf3 a trav\xe9s de milions de neurones interconnectades. Cada neurona rep senyals, les combina i genera una sortida."),(0,l.yg)("p",null,"Una neurona artificial funciona de manera an\xe0loga: rep N entrades (in\u2081, in\u2082, ..., in\u2099), les pondera amb pesos (w\u2081, w\u2082, ...), suma els resultats, afegeix un biaix, i aplica una funci\xf3 d'activaci\xf3 per generar la sortida."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(9081).A}),(0,l.yg)("figcaption",null,"Diagrama d'una neurona biol\xf2gica i model matem\xe0tic d'una neurona artificial (\u03a3 + f).")),(0,l.yg)("h4",{id:"un-exemple-senzill-aprendre-a-predir-la-pot\xe8ncia-dun-sistema-de-calefacci\xf3"},"Un exemple senzill: aprendre a predir la pot\xe8ncia d'un sistema de calefacci\xf3"),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(5333).A}),(0,l.yg)("figcaption",null,"Gr\xe0fica lineal Pot\xe8ncia-Temperatura.")),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Temperatura (\xb0C)"),(0,l.yg)("th",{parentName:"tr",align:null},"Pot\xe8ncia (%)"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"0"),(0,l.yg)("td",{parentName:"tr",align:null},"100")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"4"),(0,l.yg)("td",{parentName:"tr",align:null},"80")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"8"),(0,l.yg)("td",{parentName:"tr",align:null},"60")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"12"),(0,l.yg)("td",{parentName:"tr",align:null},"40")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"16"),(0,l.yg)("td",{parentName:"tr",align:null},"20")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"20"),(0,l.yg)("td",{parentName:"tr",align:null},"0")))),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(6331).A}),(0,l.yg)("figcaption",null,"Diagrama neurona per control de pot\xe8ncia segons temperatura.")),(0,l.yg)("p",null,"Amb una sola neurona podem aprendre aquesta relaci\xf3 lineal. La neurona apr\xe8n que ",(0,l.yg)("inlineCode",{parentName:"p"},"P = T \xb7 (-5) + 1 \xb7 100"),", \xe9s a dir: per a ",(0,l.yg)("inlineCode",{parentName:"p"},"T=12"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"P = 12\xb7(\u22125) + 100 = 40"),". El proc\xe9s d'aprenentatge consisteix a trobar autom\xe0ticament els pesos ",(0,l.yg)("inlineCode",{parentName:"p"},"w1")," i ",(0,l.yg)("inlineCode",{parentName:"p"},"Wb")," que minimitzen l'error sobre les dades conegudes."),(0,l.yg)("h3",{id:"machine-learning-i-deep-learning-reals"},"Machine learning i deep learning reals"),(0,l.yg)("p",null,"En un cas real, les xarxes s'escalen enormement. Per al fam\xf3s dataset ",(0,l.yg)("strong",{parentName:"p"},"MNIST")," de d\xedgits escrits a m\xe0 (imatges de 28\xd728 p\xedxels = 784 p\xedxels d'entrada, 10 classes de sortida):"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"La imatge d'entrada fa 28x28"),(0,l.yg)("li",{parentName:"ul"},"Cada imatge cont\xe9 un n\xfamero de 0-9"),(0,l.yg)("li",{parentName:"ul"},"Es va entrenar amb 6000 imatges classificades"),(0,l.yg)("li",{parentName:"ul"},"Amb una xarxa simple (ML), s'ha aconseguit un error de nom\xe9s ",(0,l.yg)("strong",{parentName:"li"},"0,7%")," (2003)"),(0,l.yg)("li",{parentName:"ul"},"Xarxes m\xe9s complexes (DL) han aconseguit resultats millors:",(0,l.yg)("ul",{parentName:"li"},(0,l.yg)("li",{parentName:"ul"},"LeNet: 0,7% (1998)"),(0,l.yg)("li",{parentName:"ul"},"CNN 35 capes: ",(0,l.yg)("strong",{parentName:"li"},"0,23%")," (2012)"))),(0,l.yg)("li",{parentName:"ul"},"L'error hum\xe0 en aquesta tasca \xe9s de ",(0,l.yg)("strong",{parentName:"li"},"0,2%"))),(0,l.yg)("p",null,"Les m\xe0quines s'acosten r\xe0pidament al rendiment hum\xe0, i en molts casos ja el superen."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(5729).A}),(0,l.yg)("figcaption",null,'Xarxa neuronal de 784 entrades (p\xedxels) \u2192 capa oculta \u2192 10 sortides (d\xedgits 0-9), amb imatge del d\xedgit "8" a l\'esquerra.')),(0,l.yg)("h4",{id:"deep-learning-xarxes-neuronals-grans-per-a-qualsevol-problema"},"Deep learning: xarxes neuronals grans per a qualsevol problema"),(0,l.yg)("p",null,"L'avantatge fonamental \xe9s la ",(0,l.yg)("strong",{parentName:"p"},"universalitat"),": podem crear qualsevol cosa amb qualsevol entrada i qualsevol sortida. Les entrades poden ser n\xfameros, imatges, paraules o combinacions de tot tipus. La sortida pot ser exactament el mateix."),(0,l.yg)("p",null,"En visi\xf3 artificial, ",(0,l.yg)("strong",{parentName:"p"},"l'entrada sempre son imatges")," (normalment una sola imatge) i la sortida dep\xe8n del problema: una classe (classificaci\xf3), una m\xe0scara de p\xedxels (segmentaci\xf3), unes coordenades (detecci\xf3), etc."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(904).A}),(0,l.yg)("figcaption",null,'Diagrama de xarxa CNN amb "Convolution and Pooling" \u2192 "Final conv feature map" \u2192 "Classification head" i "Regression head".')),(0,l.yg)("admonition",{type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"Una bona manera d'explicar-ho a un client: \xe9s com ensenyar a un nou treballador mostrant-li molts exemples correctes i incorrectes, en lloc de donar-li un manual de regles. La m\xe0quina apr\xe8n igual que un hum\xe0: per experi\xe8ncia.")),(0,l.yg)("h3",{id:"avaluaci\xf3-1"},"Avaluaci\xf3"),(0,l.yg)("admonition",{title:"Respon les seg\xfcents preguntes",type:"info"},(0,l.yg)("ol",{parentName:"admonition"},(0,l.yg)("li",{parentName:"ol"},'Un client et diu: "No necessito deep learning, jo ja tinc intel\xb7lig\xe8ncia artificial al meu sistema." Amb la terminologia que has apr\xe8s, com li respondries?'),(0,l.yg)("li",{parentName:"ol"},"En l'exemple de la neurona que prediu la pot\xe8ncia de calefacci\xf3, si les dades d'entrenament canviessin (per exemple, a 0\xb0C la pot\xe8ncia fos del 50% en lloc del 100%), canviaria l'arquitectura de la xarxa o nom\xe9s els pesos? Justifica la resposta."),(0,l.yg)("li",{parentName:"ol"},"Per qu\xe8 diem que el deep learning segueix un enfocament \"data driven\"? Quina \xe9s la conseq\xfc\xe8ncia pr\xe0ctica d'aix\xf2 a l'hora de posar en marxa un projecte?"))),(0,l.yg)("h2",{id:"exemples-reals"},"Exemples reals"),(0,l.yg)("h3",{id:"exemples-amb-deep-learning"},"Exemples amb deep learning"),(0,l.yg)("h4",{id:"detecci\xf3-de-defectes-en-pellets-de-pl\xe0stic"},"Detecci\xf3 de defectes en pellets de pl\xe0stic"),(0,l.yg)("p",null,"Com descriuries un defecte de cremat sense descriure tamb\xe9 una ombra? La resposta \xe9s: ",(0,l.yg)("strong",{parentName:"p"},"\xe9s impossible resoldre-ho amb visi\xf3 tradicional.")," Les ombres i els defectes de cremat comparteixen les mateixes propietats visuals a nivell de p\xedxel."),(0,l.yg)("p",null,"Amb deep learning, el model apr\xe8n a distingir-los pels seus contextos i patrons visuals globals. L'entrada del sistema \xe9s una imatge i la sortida \xe9s una imatge de probabilitats on cada p\xedxel indica la probabilitat de ser un defecte."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(111).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Domo Polymer (Blanes): detecci\xf3 de pellets amb punts negres.")),(0,l.yg)("p",null,"Pots trobar el punt negre en aquesta imatge?"),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(4910).A}),(0,l.yg)("figcaption",null,"On est\xe0 el punt negre?")),(0,l.yg)("h4",{id:"detecci\xf3-de-lorientaci\xf3-duna-ampolla"},"Detecci\xf3 de l'orientaci\xf3 d'una ampolla"),(0,l.yg)("p",null,"La sortida d'un model DL per a aquest problema podria ser de dos tipus: una classificaci\xf3 (probabilitat que l'ampolla estigui dreta o girada) o una segmentaci\xf3 que detecta la zona on hi ha el tap i la soldadura, assignant probabilitat per p\xedxel a cada element."),(0,l.yg)("p",null,"Ambdues opcions serien extremadament complexes de codificar amb visi\xf3 cl\xe0ssica, ja que les ampolles arriben en posicions, llums i orientacions molt diverses."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(6027).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Traktech (Terrassa): diverses ampolles en posicions horitzontals.")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(6789).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Traktech (Terrassa): resultat de la infer\xe8ncia per trobar el cos i la rosca de l'ampolla.")),(0,l.yg)("h4",{id:"comptar-mandonguilles"},"Comptar mandonguilles"),(0,l.yg)("p",null,"La detecci\xf3 i el recompte de mandonguilles sembla un problema molt senzill per a un hum\xe0, per\xf2 costa pensar en un algoritme de visi\xf3 cl\xe0ssica que pugui resoldre-ho de forma robusta: les mandonguilles es toquen, es superposen, varien de mida i de color."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Amb deep learning, el problema \xe9s molt senzill.")," Un model d'instance segmentation identifica cada mandonguilla individualment i les compta, fins i tot quan es toquen."),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(1234).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Masia Artesana (Les Borges Blanques): comptatge de mandonguilles en una safata.")),(0,l.yg)("h3",{id:"exemples-amb-visi\xf3-tradicional"},"Exemples amb visi\xf3 tradicional"),(0,l.yg)("p",null,"La visi\xf3 cl\xe0ssica no ha desaparegut: en determinats contextos continua sent la millor opci\xf3, i en molts projectes conviuen les dues t\xe8cniques."),(0,l.yg)("h4",{id:"mesura-de-peces-metrologia"},"Mesura de peces (metrologia)"),(0,l.yg)("p",null,"En aquest projecte de mesura dimensional de peces cil\xedndriques, la distribuci\xf3 de tasques entre visi\xf3 cl\xe0ssica i DL \xe9s clara:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"C\xe0meres 2 i 4")," (mesura de cotes i circularitat) \u2192 visi\xf3 cl\xe0ssica, perqu\xe8 requereix precisi\xf3 geom\xe8trica absoluta"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"C\xe0mera 3")," (detecci\xf3 de defectes superficials al cap) \u2192 deep learning, perqu\xe8 els defectes no es poden descriure algor\xedtmicament")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(3257).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Masia Artesana (Les Borges Blanques): 6 vistes de c\xe0meres (Corona 1, Corona 2, Horizontal, Cabeza, Medidas, Fondo) i resultats OK/NOK.")),(0,l.yg)("h4",{id:"matching-de-patrons"},"Matching de patrons"),(0,l.yg)("p",null,"Amb visi\xf3 cl\xe0ssica es pot fer ",(0,l.yg)("em",{parentName:"p"},"pattern matching"),": es troben punts caracter\xedstics d'una imatge de refer\xe8ncia i es comparen amb els d'una imatge nova. Funciona b\xe9 per localitzar etiquetes, peces o elements estructurats."),(0,l.yg)("p",null,"Les t\xe8cniques cl\xe0ssiques, per\xf2, presenten problemes amb elements que tenen certes simetries (com codis de barres) o poc contrast. ",(0,l.yg)("strong",{parentName:"p"},"Actualment hi ha t\xe8cniques de DL per fer exactament aix\xf2 amb millores significatives de robustesa i rendiment.")),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(6947).A}),(0,l.yg)("figcaption",null,"Exemple d'aplicaci\xf3 real del client Masia Artesana (Les Borges Blanques): imatges de llaunes i el matching entre la recepta i la imatge de treball.")),(0,l.yg)("h3",{id:"avaluaci\xf3-2"},"Avaluaci\xf3"),(0,l.yg)("admonition",{title:"Respon les seg\xfcents preguntes",type:"info"},(0,l.yg)("ol",{parentName:"admonition"},(0,l.yg)("li",{parentName:"ol"},"En el projecte de peces cil\xedndriques, les c\xe0meres de mesura utilitzen visi\xf3 cl\xe0ssica i la de defectes utilitza DL. Podria ser al rev\xe9s? Justifica la resposta."),(0,l.yg)("li",{parentName:"ol"},"Un client et planteja un projecte on cal comptar objectes que es toquen i es superposen. Quin tipus de model de DL li proposaries i per qu\xe8 no funcionaria un enfocament de visi\xf3 cl\xe0ssica?"))),(0,l.yg)("h2",{id:"el-futur-el-cervell-\xe9s-una-m\xe0quina-incre\xefble-per\xf2-ens-estem-acostant"},"El futur: el cervell \xe9s una m\xe0quina incre\xefble, per\xf2 ens estem acostant"),(0,l.yg)("p",null,"El 2012, Andrej Karpathy argumentava que entendre escenes complexes des del punt de vista cognitiu era extremadament lluny per a les m\xe0quines:"),(0,l.yg)("figure",null,(0,l.yg)("img",{src:n(9091).A}),(0,l.yg)("figcaption",null,"Foto complexa d'un grup de persones en un vestidor (usada per Karpathy el 2012 com a exemple d'escena impossible d'entendre per una m\xe0quina).")),(0,l.yg)("p",null,"Posava com a exemple aquesta fotografia: un cervell hum\xe0 ent\xe9n la situaci\xf3 pr\xe0cticament a l'instant \u2014qui \xe9s qui, que fan, on estan\u2014, per\xf2 el 2012 cap m\xe0quina podia ni aproximar-s'hi."),(0,l.yg)("p",null,(0,l.yg)("em",{parentName:"p"},"Andrej Karpathy. \u201cThe state of Computer Vision and AI: we are really, really far away.\u201d ",(0,l.yg)("a",{parentName:"em",href:"http://karpathy.github.io/2012/10/22/state-of-computer-vision/"},"http://karpathy.github.io/2012/10/22/state-of-computer-vision/"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Avui, els LLM encara tenen problemes per entendre aquesta imatge.")," Resposta Claude Sonnet 4.6:"),(0,l.yg)("blockquote",null,(0,l.yg)("p",{parentName:"blockquote"},(0,l.yg)("em",{parentName:"p"},"La imatge mostra un grup d'homes amb vestit i corbata en el que sembla ser un vestidor o passad\xeds d'instal\xb7lacions esportives, amb taquilles taronges al fons i un terra de rajoles de quadres verds i blancs. Al centre de l'escena, un home est\xe0 dret sobre una b\xe0scula de pesatge de les antigues (de columna met\xe0l\xb7lica), mentre un altre home sembla estar ajustant-la o llegint el pes. Els homes del voltant somriuen i riuen, cosa que suggereix un moment dist\xe8s i humor\xedstic. La imatge t\xe9 un aspecte fotogr\xe0fic professional i el context \u2014molts homes amb vestit, l'ambient informal per\xf2 protocolari\u2014 fa pensar que podria tractar-se d'un moment capturat durant algun esdeveniment oficial o visita institucional."))),(0,l.yg)("p",null,"Despr\xe9s d'insistir que busqui el motiu humor\xedstic:"),(0,l.yg)("blockquote",null,(0,l.yg)("p",{parentName:"blockquote"},(0,l.yg)("em",{parentName:"p"},"Mirant m\xe9s detingudament, el moment humor\xedstic sembla ser que un dels homes est\xe0 posant el peu a la b\xe0scula de l'altre per fer-li pesar m\xe9s del que realment pesa, una broma cl\xe0ssica i universal que tothom reconeix i que provoca les rialles dels presents! \xc9s una situaci\xf3 molt c\xf2mica precisament perqu\xe8 \xe9s una broma tan senzilla i atemporal, feta en un context molt formal amb tots ells vestits de manera protocol\xb7l\xe0ria."))),(0,l.yg)("p",null,"Tot i aix\xf2, el progr\xe9s en menys de 15 anys ha estat extraordinari, i el camp continua avan\xe7ant acceleradament. Els sistemes industrials d'avui estan resolent problemes que fa una d\xe8cada semblaven impossibles."),(0,l.yg)("h2",{id:"resum-quan-usar-deep-learning-i-quan-visi\xf3-cl\xe0ssica"},"Resum: quan usar deep learning i quan visi\xf3 cl\xe0ssica"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Situaci\xf3"),(0,l.yg)("th",{parentName:"tr",align:null},"Recomanaci\xf3"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Mesura de dimensions precises"),(0,l.yg)("td",{parentName:"tr",align:null},"Visi\xf3 cl\xe0ssica")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Lectura de codis de barres"),(0,l.yg)("td",{parentName:"tr",align:null},"Visi\xf3 cl\xe0ssica")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Defectes de forma variable i/o ambigua"),(0,l.yg)("td",{parentName:"tr",align:null},"Deep learning")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Productes amb moltes variants o refer\xe8ncies"),(0,l.yg)("td",{parentName:"tr",align:null},"Deep learning")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Inspecci\xf3 subjectiva (qualitat visual)"),(0,l.yg)("td",{parentName:"tr",align:null},"Deep learning")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Entorns amb variabilitat de llum o posici\xf3"),(0,l.yg)("td",{parentName:"tr",align:null},"Deep learning")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Combinaci\xf3 de detecci\xf3 + metrologia"),(0,l.yg)("td",{parentName:"tr",align:null},"H\xedbrid (DL + cl\xe0ssica)")))),(0,l.yg)("admonition",{type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"La pregunta clau a fer al client \xe9s: ",(0,l.yg)("strong",{parentName:"p"},'"Ho podria fer un hum\xe0 mirant la imatge?"')," Si la resposta \xe9s s\xed, probablement ho podem resoldre amb deep learning. Si requereix un calibre o una regla, probablement necessita visi\xf3 cl\xe0ssica o una combinaci\xf3.")))}u.isMDXComponent=!0},6789:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/traktech-resultats-dl-885bcf4dfaea537f1d32df2574c17dfe.png"},6947:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/imatges-saeby-ff7b3cc90088f0a9917815c189fc78e9.png"},7643:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/algoritme-visio-classica-fd976ba8078b87717fc22bf47007c247.png"},7742:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/classificacio-dl-3a6ceb190ba8f8242f261d3fd06bd0b2.png"},8137:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/autovision-c44fe0ae1d9cb40baabcfb9c8afeb23d.png"},8924:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/confusio-gos-152bc9aeb3dd4e4d6534af1c69f329d5.png"},9081:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/neurona-biologica-artificial-053ebe62f787016b5e7b87afb8e90af6.png"},9091:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/obama-balanca-ce7bbf2a16c365576845c3ec2b269b5f.png"},9570:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/timeline-ia-4941935f47e68c4b0cd308755ae22978.png"}}]);