"use strict";(globalThis.webpackChunk_indeepvision_idvision_docs=globalThis.webpackChunk_indeepvision_idvision_docs||[]).push([[9179],{2247:(e,a,t)=>{t.d(a,{xA:()=>u,yg:()=>d});var r=t(4041);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var o=r.createContext({}),c=function(e){var a=r.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},u=function(e){var a=c(e.components);return r.createElement(o.Provider,{value:a},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},g=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=c(t),g=n,d=m["".concat(o,".").concat(g)]||m[g]||p[g]||i;return t?r.createElement(d,l(l({ref:a},u),{},{components:t})):r.createElement(d,l({ref:a},u))}));function d(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var i=t.length,l=new Array(i);l[0]=g;var s={};for(var o in a)hasOwnProperty.call(a,o)&&(s[o]=a[o]);s.originalType=e,s[m]="string"==typeof e?e:n,l[1]=s;for(var c=2;c<i;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},5166:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=t(9575),n=(t(4041),t(2247));const i={sidebar_position:1},l="Passos a seguir",s={unversionedId:"projectes/onboarding/exercici-practic/passos",id:"projectes/onboarding/exercici-practic/passos",title:"Passos a seguir",description:"A continuaci\xf3 s'exposa a grans trets els passos a seguir per completar aquest exercici. No s'explica tot de forma exhaustiva: fer servir aquest document com a guia o requisits m\xednims. Un cop completada la funcionalitat m\xednima, pots experimentar afegint m\xe9s funcionalitat.",source:"@site/docs/projectes/onboarding/exercici-practic/passos.md",sourceDirName:"projectes/onboarding/exercici-practic",slug:"/projectes/onboarding/exercici-practic/passos",permalink:"/dev/docs/projectes/onboarding/exercici-practic/passos",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"onboardingProjectes",previous:{title:"Definici\xf3",permalink:"/dev/docs/projectes/onboarding/exercici-practic/definicio"},next:{title:"Troubleshooting",permalink:"/dev/docs/projectes/onboarding/exercici-practic/troubleshooting"}},o={},c=[{value:"Importar projecte plantilla",id:"importar-projecte-plantilla",level:2},{value:"\u2705 Objectius",id:"-objectius",level:4},{value:"Preparar setup",id:"preparar-setup",level:2},{value:"\u2705 Objectius",id:"-objectius-1",level:4},{value:"Localitzar el centre de les cubetes",id:"localitzar-el-centre-de-les-cubetes",level:2},{value:"\u2705 Objectius",id:"-objectius-2",level:4},{value:"Delimitar les cubetes amb rectangles",id:"delimitar-les-cubetes-amb-rectangles",level:2},{value:"\u2705 Objectius",id:"-objectius-3",level:4},{value:"Classificar el contingut de les cubetes",id:"classificar-el-contingut-de-les-cubetes",level:2},{value:"\u2705 Objectius",id:"-objectius-4",level:4},{value:"An\xe0lisi de contaminaci\xf3 i mostra de resultats",id:"an\xe0lisi-de-contaminaci\xf3-i-mostra-de-resultats",level:2},{value:"\u2705 Objectius",id:"-objectius-5",level:4}],u={toc:c},m="wrapper";function p({components:e,...a}){return(0,n.yg)(m,(0,r.A)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"passos-a-seguir"},"Passos a seguir"),(0,n.yg)("p",null,"A continuaci\xf3 s'exposa a grans trets els passos a seguir per completar aquest exercici. No s'explica tot de forma exhaustiva: fer servir aquest document com a guia o requisits m\xednims. Un cop completada la funcionalitat m\xednima, pots experimentar afegint m\xe9s funcionalitat."),(0,n.yg)("h2",{id:"importar-projecte-plantilla"},"Importar projecte plantilla"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Descarregar el projecte plantilla des ",(0,n.yg)("a",{parentName:"li",href:"../../guia/scripting/projecte-plantilla"},"d'aquesta p\xe0gina.")),(0,n.yg)("li",{parentName:"ul"},"Importar el projecte i assignar-li aquest nom al importar-lo: ",(0,n.yg)("inlineCode",{parentName:"li"},"showkit3_{el-teu-nom}"),".")),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"Fem servir snake_case pels noms dels projectes.")),(0,n.yg)("h4",{id:"-objectius"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Importar el projecte plantilla i canviar el nom del projecte a l'importar.")),(0,n.yg)("h2",{id:"preparar-setup"},"Preparar setup"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Demanar la c\xe0mera del magatzem."),(0,n.yg)("li",{parentName:"ul"},"Aconseguir caixa amb les cubetes, hauria d'estar al taller o per l'oficina."),(0,n.yg)("li",{parentName:"ul"},"Afegir c\xe0mera al projecte i connectar-se a la c\xe0mera."),(0,n.yg)("li",{parentName:"ul"},"Assegurar que el flat dome est\xe0 enc\xe8s de forma fixa."),(0,n.yg)("li",{parentName:"ul"},"Les imatges es capturen sense la tapa de la caixa de cubetes."),(0,n.yg)("li",{parentName:"ul"},"Setejar els par\xe0metres de la c\xe0mera a la seq\xfc\xe8ncia ",(0,n.yg)("inlineCode",{parentName:"li"},"initCam"),"."),(0,n.yg)("li",{parentName:"ul"},"Definir els par\xe0metres de la c\xe0mera per aconseguir ",(0,n.yg)("a",{parentName:"li",href:"https://cloud.id-vision.com/org/1/projects/126/datasets/1566/3/elements/514045"},"imatges similars a les d'entrenament."))),(0,n.yg)("h4",{id:"-objectius-1"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Configurar les c\xe0meres en la seq\xfc\xe8ncia INIT."),(0,n.yg)("li",{parentName:"ul"},"Tenir el llum enc\xe8s de forma fixa."),(0,n.yg)("li",{parentName:"ul"},"Fer fotos amb la c\xe0mera i aconseguir imatges similars a les utilitzades per entrenar."),(0,n.yg)("li",{parentName:"ul"},"Poder executar mode v\xeddeo amb la c\xe0mera.")),(0,n.yg)("h2",{id:"localitzar-el-centre-de-les-cubetes"},"Localitzar el centre de les cubetes"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Descarregar ",(0,n.yg)("a",{parentName:"li",href:"https://cloud.id-vision.com/org/1/projects/126/models/242/2/definition"},"el model que localitza els centres"),". Aquest model es diu ",(0,n.yg)("inlineCode",{parentName:"li"},"af2024_loc_containers")," i fem servir la versi\xf3 ",(0,n.yg)("inlineCode",{parentName:"li"},"2"),"."),(0,n.yg)("li",{parentName:"ul"},"Importar el model i assignar-lo a un brain amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"segmCentres"),"."),(0,n.yg)("li",{parentName:"ul"},"Configurar la seq\xfc\xe8ncia ",(0,n.yg)("inlineCode",{parentName:"li"},"run")," del projecte per fer foto a cada cicle."),(0,n.yg)("li",{parentName:"ul"},"Enviar Capture amb la imatge al display."),(0,n.yg)("li",{parentName:"ul"},"Afegir processament d'imatge per detectar el centre de les cubetes amb DL."),(0,n.yg)("li",{parentName:"ul"},"El model s'ha d'executar sobre tota la imatge RGB, havent redimensionat pr\xe8viament la imatge a 306x256."),(0,n.yg)("li",{parentName:"ul"},"Crea una Action amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"mostrarCentreCubetes")," que mostri opcionalment la segmentaci\xf3 del centre de les cubetes."),(0,n.yg)("li",{parentName:"ul"},"Assigna a les segmentacions el nom ",(0,n.yg)("inlineCode",{parentName:"li"},"segmCentreCubeta")," i mostra'ls sota el grup ",(0,n.yg)("inlineCode",{parentName:"li"},"centresCubetes"),".")),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"Fem servir camelCase per les variables dintre OneVision, i els brains es fan servir com a variables quan es fa ",(0,n.yg)("inlineCode",{parentName:"p"},"Brains.segmCentres.inference()"),".")),(0,n.yg)("h4",{id:"-objectius-2"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Executar cicles d'adquisici\xf3-processament de forma cont\xednua."),(0,n.yg)("li",{parentName:"ul"},"Mostrar la segmentaci\xf3 dels centres lligada a l'estat d'una Action."),(0,n.yg)("li",{parentName:"ul"},"Has de provar que si mous les cubetes o tota la caixa es desplacen els centres.")),(0,n.yg)("h2",{id:"delimitar-les-cubetes-amb-rectangles"},"Delimitar les cubetes amb rectangles"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Descarregar ",(0,n.yg)("a",{parentName:"li",href:"https://cloud.id-vision.com/org/1/projects/126/models/245/1/definition"},"el model que troba el contorn de les cubetes"),". Aquest model es diu ",(0,n.yg)("inlineCode",{parentName:"li"},"af2024_s3_area_vertical")," i fem servir la versi\xf3 ",(0,n.yg)("inlineCode",{parentName:"li"},"1"),"."),(0,n.yg)("li",{parentName:"ul"},"Importar el model i assignar-lo a un brain amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"segmCubeta"),"."),(0,n.yg)("li",{parentName:"ul"},"El model s'ha d'executar una vegada per cada cubeta."),(0,n.yg)("li",{parentName:"ul"},"El model s'ha d'executar sobre un crop RGB de 800x1100 px centrat en cadascun dels centres trobats en el pas anterior."),(0,n.yg)("li",{parentName:"ul"},"Aquest crop s'ha de redimensinonar a 400x550 abans de fer la infer\xe8ncia."),(0,n.yg)("li",{parentName:"ul"},"Per transformar la segmentaci\xf3 a les coordenades globals de la imatge (estaran en les coordenades del crop), fer servir la funci\xf3 ",(0,n.yg)("inlineCode",{parentName:"li"},"setFrame()"),"."),(0,n.yg)("li",{parentName:"ul"},"Quedar-se amb la segmentaci\xf3 m\xe9s gran i filtrar per mida per tal que no trobi cubetes de mida molt petita (poden ser un error del model)."),(0,n.yg)("li",{parentName:"ul"},"Despr\xe9s trobar el contorn i fer buscar el rectangle ortogonal que envolta la segmentaci\xf3."),(0,n.yg)("li",{parentName:"ul"},"Mostrar tots els rectangles per pantalla, de color verd."),(0,n.yg)("li",{parentName:"ul"},"Assigna al rectangles el nom ",(0,n.yg)("inlineCode",{parentName:"li"},"rectCubeta")," i mostra'ls sota el grup ",(0,n.yg)("inlineCode",{parentName:"li"},"rectCubetes"),"."),(0,n.yg)("li",{parentName:"ul"},"Crea una Action amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"mostrarSegmCubetes")," que mostri opcionalment la segmentaci\xf3 de cubetes en la posici\xf3 correcta."),(0,n.yg)("li",{parentName:"ul"},"Assigna a les segmentacions el nom ",(0,n.yg)("inlineCode",{parentName:"li"},"segmCubeta")," i mostra'ls sota el grup ",(0,n.yg)("inlineCode",{parentName:"li"},"segmCubetes"),".")),(0,n.yg)("admonition",{type:"tip"},(0,n.yg)("p",{parentName:"admonition"},"Fes servir variables de configuraci\xf3 definides a la seq\xfc\xe8ncia ",(0,n.yg)("inlineCode",{parentName:"p"},"config")," per assignar colors als Vision Elements, per tal que la combinaci\xf3 de colors sigui m\xe9s uniforme.")),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"Seria millor fer aquesta tasca amb instance segmentation, per trobar cada inst\xe0ncia de cubeta i segmentar-la, per\xf2 per aquest exercici no ho farem. Aquest model est\xe0 configurat al VisionCloud d'una forma una mica especial, per tal de trobar nom\xe9s l'element que est\xe0 al centre de la imatge.")),(0,n.yg)("h4",{id:"-objectius-3"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Aprendre a transformar la posici\xf3 de les segmentacions (s\xf3n imatges)."),(0,n.yg)("li",{parentName:"ul"},"Mostrar rectangles al voltant de les cubetes."),(0,n.yg)("li",{parentName:"ul"},"No mostrar el rectangle si no hi ha cubeta, que no hi hagi falsos positius."),(0,n.yg)("li",{parentName:"ul"},"Afegir una Action que mostri opcionalment el contingut de les cubetes.")),(0,n.yg)("h2",{id:"classificar-el-contingut-de-les-cubetes"},"Classificar el contingut de les cubetes"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Descarregar ",(0,n.yg)("a",{parentName:"li",href:"https://cloud.id-vision.com/org/1/projects/126/models/544/3/definition"},"el model que troba el contorn de les cubetes"),". Aquest model es diu ",(0,n.yg)("inlineCode",{parentName:"li"},"af2024_s3_detection_whole")," i fem servir la versi\xf3 ",(0,n.yg)("inlineCode",{parentName:"li"},"3"),"."),(0,n.yg)("li",{parentName:"ul"},"Importar el model i assignar-lo a un brain amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"segmFruitsSecs"),"."),(0,n.yg)("li",{parentName:"ul"},"Aquest model est\xe0 configurat per treballar amb patches RGB de 700x1000, que es redimensionen per la infer\xe8ncia a 350x500."),(0,n.yg)("li",{parentName:"ul"},"Executa patch inference individualment a cada cubeta en resoluci\xf3 original de la imatge sobre un crop del rectangle que cont\xe9 la cubeta."),(0,n.yg)("li",{parentName:"ul"},"Pel patch inference fer servir context padding de 40px. ",(0,n.yg)("a",{parentName:"li",href:"https://docs.id-vision.com/onevision/docs/software-guide/project/brains/execute-inference"},"Veure aqu\xed")," qu\xe8 \xe9s el context padding."),(0,n.yg)("li",{parentName:"ul"},"El model retorna una segmentaci\xf3 per cada tipus de fruit sec, configurar cada segmentaci\xf3 amb un color diferent segons el tipus de fruit sec segons taula a continuaci\xf3."),(0,n.yg)("li",{parentName:"ul"},"Transformar el resultat de la infer\xe8ncia a les coordenades globals de la imatge amb ",(0,n.yg)("inlineCode",{parentName:"li"},"setFrame()"),"."),(0,n.yg)("li",{parentName:"ul"},"Buscar el contorn de cada segmentaci\xf3 i assignar al contorn el mateix color que fruit sec i el nom corresponent."),(0,n.yg)("li",{parentName:"ul"},"Les segmentacions i contorns s'han d'afegir a la capture en un grup amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"cubeta{Num}"),", per tal que els resultats de cada cubeta estiguin en un grup independent.")),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Nom fruit sec"),(0,n.yg)("th",{parentName:"tr",align:null},"Color"),(0,n.yg)("th",{parentName:"tr",align:null},"Nom segmentaci\xf3"),(0,n.yg)("th",{parentName:"tr",align:null},"Nom contorn"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Ametlla")),(0,n.yg)("td",{parentName:"tr",align:null},"Verd"),(0,n.yg)("td",{parentName:"tr",align:null},"segmAmetlla"),(0,n.yg)("td",{parentName:"tr",align:null},"contAmetlla")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Nou")),(0,n.yg)("td",{parentName:"tr",align:null},"Blau"),(0,n.yg)("td",{parentName:"tr",align:null},"segmNou"),(0,n.yg)("td",{parentName:"tr",align:null},"contNou")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Pistatxo")),(0,n.yg)("td",{parentName:"tr",align:null},"Rosa"),(0,n.yg)("td",{parentName:"tr",align:null},"segmPistatxo"),(0,n.yg)("td",{parentName:"tr",align:null},"contPistatxo")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Pansa")),(0,n.yg)("td",{parentName:"tr",align:null},"Taronja"),(0,n.yg)("td",{parentName:"tr",align:null},"segmPansa"),(0,n.yg)("td",{parentName:"tr",align:null},"contPansa")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Cacahuet")),(0,n.yg)("td",{parentName:"tr",align:null},"Groc"),(0,n.yg)("td",{parentName:"tr",align:null},"segmCacahuet"),(0,n.yg)("td",{parentName:"tr",align:null},"contCacahuet")))),(0,n.yg)("h4",{id:"-objectius-4"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Entendre com funciona el patch inference i el context padding."),(0,n.yg)("li",{parentName:"ul"},"Mostrar diverses segmentacions en llocs diferents fent servir ",(0,n.yg)("inlineCode",{parentName:"li"},"setFrame()"),"."),(0,n.yg)("li",{parentName:"ul"},"Configurar com es visualitzen les segmentacions (en aquest cas amb colors diferents).")),(0,n.yg)("h2",{id:"an\xe0lisi-de-contaminaci\xf3-i-mostra-de-resultats"},"An\xe0lisi de contaminaci\xf3 i mostra de resultats"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Per cada cubeta mostrar en la cantonada superior esquerra els noms dels fruits secs presents, un a sota de l'altre, fent servir el vision element String. Posicionar fent servir ",(0,n.yg)("inlineCode",{parentName:"li"},"setAnchor()"),"."),(0,n.yg)("li",{parentName:"ul"},"Afegir aquests noms al grup per cada cubeta amb nom ",(0,n.yg)("inlineCode",{parentName:"li"},"cubeta{Num}"),"."),(0,n.yg)("li",{parentName:"ul"},"Inicialment mostrar els textos de color verd."),(0,n.yg)("li",{parentName:"ul"},"Afegir Actions per tal d'habilitar o deshabilitar l'acceptaci\xf3 de fruits secs a la imatge. Per defecte aquestes Actions per cada fruit sec estaran totes habilitades."),(0,n.yg)("li",{parentName:"ul"},"Modificar el programa per tal que si en una cubeta hi ha pres\xe8ncia d'un fruit sec no acceptat per les Actions (contaminaci\xf3), es mostri el text d'aquell fruit sec en vermell."),(0,n.yg)("li",{parentName:"ul"},"Si hi ha contaminaci\xf3, mostrar el rectangle de la cubeta tamb\xe9 en vermell. Aix\xf2 es pot fer modificant la variable del rectangle, encara que s'hagi afegit anteriorment a la capture (funciona per refer\xe8ncies, no \xe9s una c\xf2pia).")),(0,n.yg)("h4",{id:"-objectius-5"},"\u2705 Objectius"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"L\xf2gica avan\xe7ada fent servir Actions."),(0,n.yg)("li",{parentName:"ul"},"Afegir text a una Capture."),(0,n.yg)("li",{parentName:"ul"},"Entendre com funcionen els objectes a OneVision: funcionen per refer\xe8ncia com a Javascript.")))}p.isMDXComponent=!0}}]);