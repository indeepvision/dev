"use strict";(globalThis.webpackChunk_indeepvision_idvision_docs=globalThis.webpackChunk_indeepvision_idvision_docs||[]).push([[9664],{2247:(e,n,i)=>{i.d(n,{xA:()=>u,yg:()=>g});var a=i(4041);function r(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function t(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(n){r(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function s(e,n){if(null==e)return{};var i,a,r=function(e,n){if(null==e)return{};var i,a,r={},t=Object.keys(e);for(a=0;a<t.length;a++)i=t[a],n.indexOf(i)>=0||(r[i]=e[i]);return r}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(a=0;a<t.length;a++)i=t[a],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var o=a.createContext({}),c=function(e){var n=a.useContext(o),i=n;return e&&(i="function"==typeof e?e(n):l(l({},n),e)),i},u=function(e){var n=c(e.components);return a.createElement(o.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var i=e.components,r=e.mdxType,t=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(i),d=r,g=p["".concat(o,".").concat(d)]||p[d]||m[d]||t;return i?a.createElement(g,l(l({ref:n},u),{},{components:i})):a.createElement(g,l({ref:n},u))}));function g(e,n){var i=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var t=i.length,l=new Array(t);l[0]=d;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s[p]="string"==typeof e?e:r,l[1]=s;for(var c=2;c<t;c++)l[c]=i[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,i)}d.displayName="MDXCreateElement"},2540:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>t,metadata:()=>s,toc:()=>c});var a=i(9575),r=(i(4041),i(2247));const t={sidebar_position:0},l="Interf\xedcie p\xfablica",s={unversionedId:"software/computer-vision/vision-elements/interficie-publica",id:"software/computer-vision/vision-elements/interficie-publica",title:"Interf\xedcie p\xfablica",description:"Com escriure Vision Elements",source:"@site/docs/software/computer-vision/vision-elements/interficie-publica.md",sourceDirName:"software/computer-vision/vision-elements",slug:"/software/computer-vision/vision-elements/interficie-publica",permalink:"/dev/docs/software/computer-vision/vision-elements/interficie-publica",draft:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0},sidebar:"computerVision",next:{title:"Naming",permalink:"/dev/docs/software/computer-vision/vision-elements/naming"}},o={},c=[{value:"Com escriure Vision Elements",id:"com-escriure-vision-elements",level:2},{value:"Estructura general",id:"estructura-general",level:2},{value:"Un sol namespace",id:"un-sol-namespace",level:2},{value:"Definici\xf3 i ubicaci\xf3 dels tipus p\xfablics",id:"definici\xf3-i-ubicaci\xf3-dels-tipus-p\xfablics",level:2},{value:"Contracte de validaci\xf3 d&#39;arguments",id:"contracte-de-validaci\xf3-darguments",level:2},{value:"In-place o return-new",id:"in-place-o-return-new",level:2},{value:"Coher\xe8ncia sem\xe0ntica i override de funcions",id:"coher\xe8ncia-sem\xe0ntica-i-override-de-funcions",level:2},{value:"No copiar props autom\xe0ticament",id:"no-copiar-props-autom\xe0ticament",level:2},{value:"Ordre de les funcions",id:"ordre-de-les-funcions",level:2}],u={toc:c},p="wrapper";function m({components:e,...n}){return(0,r.yg)(p,(0,a.A)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"interf\xedcie-p\xfablica"},"Interf\xedcie p\xfablica"),(0,r.yg)("h2",{id:"com-escriure-vision-elements"},"Com escriure Vision Elements"),(0,r.yg)("p",null,"Quan s'escriu ",(0,r.yg)("em",{parentName:"p"},"Vision Element"),", en singular o plural, sense fer refer\xe8ncia a la classe base ",(0,r.yg)("inlineCode",{parentName:"p"},"VisionElement")," s'ha de fer amb un espai entre les dues paraules."),(0,r.yg)("p",null,"Quan es volen fer abreviacions es pot utilitzar VE o ve. Per exemple, en noms de carpetes: ",(0,r.yg)("inlineCode",{parentName:"p"},"classes-ve"),', o en documentaci\xf3 interna: "el tipus de VE".'),(0,r.yg)("p",null,"No fer servir abreviacions a la interf\xedcie p\xfablica ni a la documentaci\xf3 p\xfablica (OneVision Docs i VisionCloud Docs)."),(0,r.yg)("h2",{id:"estructura-general"},"Estructura general"),(0,r.yg)("p",null,"La llibreria es construeix a partir d'una estructura modular clara i expl\xedcita."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"La unitat principal d'organitzaci\xf3 \xe9s el m\xf2dul (p. ex. ",(0,r.yg)("inlineCode",{parentName:"li"},"geom2d"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"image"),", etc.)."),(0,r.yg)("li",{parentName:"ul"},"Cada m\xf2dul cont\xe9 subm\xf2duls que encapsulen funcionalitats espec\xedfiques (p. ex. ",(0,r.yg)("inlineCode",{parentName:"li"},"geom2d/intersect"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"geom2d/offset"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"image/io"),", etc.).")),(0,r.yg)("h2",{id:"un-sol-namespace"},"Un sol namespace"),(0,r.yg)("p",null,"La interf\xedcie p\xfablica de la llibreria exposa un \xfanic namespace principal. No s'utilitzen sub-namespaces en l'API p\xfablica."),(0,r.yg)("p",null,"Les eines d'autocompleci\xf3 com IntelliSense o clangd prioritzen la navegaci\xf3 per namespaces per davant de les funcions, de manera que una jerarquia amb m\xfaltiples sub-namespaces obliga l'usuari a con\xe8ixer pr\xe8viament l'estructura interna de la llibreria per poder localitzar una funci\xf3 concreta. L'\xfas d'un \xfanic namespace p\xfablic elimina aquesta depend\xe8ncia, millora la descobribilitat de l'API i redueix significativament la fricci\xf3 d'\xfas."),(0,r.yg)("h2",{id:"definici\xf3-i-ubicaci\xf3-dels-tipus-p\xfablics"},"Definici\xf3 i ubicaci\xf3 dels tipus p\xfablics"),(0,r.yg)("p",null,"Els tipus p\xfablics compartits entre diversos subm\xf2duls es defineixen en un arxiu anomenat ",(0,r.yg)("inlineCode",{parentName:"p"},"types.hh"),". Si els tipus nom\xe9s pertanyen a un subm\xf2dul, aquests es defineixen en un arxiu anomenat ",(0,r.yg)("inlineCode",{parentName:"p"},"{subm\xf2dul}-types.hh"),"."),(0,r.yg)("p",null,"En el cas de la interf\xedcie de TypeScript, l'arxiu on es defineixen els tipus ha de mantenir la mateixa estructura que l'arxiu de C++ per\xf2 amb l'extensi\xf3 ",(0,r.yg)("inlineCode",{parentName:"p"},".ts")," en comptes de ",(0,r.yg)("inlineCode",{parentName:"p"},".d.ts"),"."),(0,r.yg)("h2",{id:"contracte-de-validaci\xf3-darguments"},"Contracte de validaci\xf3 d'arguments"),(0,r.yg)("p",null,"La validaci\xf3 d'arguments segueix un contracte clar entre capes."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Interf\xedcie p\xfablica:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"\xc9s l'\xfanic lloc on es fa validaci\xf3 l\xf2gica completa dels arguments."),(0,r.yg)("li",{parentName:"ul"},"Es comproven invariants, rangs, coher\xe8ncia entre par\xe0metres, etc."),(0,r.yg)("li",{parentName:"ul"},"Qualsevol \xfas incorrecte de l'API ha de ser detectat aqu\xed.")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Implementaci\xf3:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Assumeix que tots els arguments s\xf3n v\xe0lids."),(0,r.yg)("li",{parentName:"ul"},"Nom\xe9s pot contenir validacions m\xednimes o asserts interns si s\xf3n estrictament necessaris."),(0,r.yg)("li",{parentName:"ul"},"No ha de repetir comprovacions fetes a la interf\xedcie p\xfablica.")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Bindings (Node.js):")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Nom\xe9s es valida:",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"Que tots els arguments existeixin."),(0,r.yg)("li",{parentName:"ul"},"Que siguin del tipus correcte."))),(0,r.yg)("li",{parentName:"ul"},"No es valida la l\xf2gica dels valors."),(0,r.yg)("li",{parentName:"ul"},"En altres paraules, es comprova que ",(0,r.yg)("inlineCode",{parentName:"li"},"info[]")," contingui tot el necessari, per\xf2 no que els valors siguin coherents.")),(0,r.yg)("p",null,"L'objectiu \xe9s reduir qualsevol overhead innecessari, especialment en funcions que s'executen de manera intensiva o repetida, definir de manera inequ\xedvoca on es realitza la validaci\xf3 d'arguments per evitar duplicitats i ambig\xfcitats entre capes, i mantenir la implementaci\xf3 interna simple, clara i centrada exclusivament en el rendiment i la l\xf2gica funcional."),(0,r.yg)("h2",{id:"in-place-o-return-new"},"In-place o return-new"),(0,r.yg)("p",null,"La llibreria segueix una pol\xedtica de noms impl\xedcita, \xe9s a dir, el comportament per defecte es considera impl\xedcit quan una funci\xf3 t\xe9 un comportament diferent es posa expl\xedcitament en el nom. Quan les funcions tenen una variant return-new, porten ",(0,r.yg)("inlineCode",{parentName:"p"},"_new")," en el nom. Aix\xf2 es fa perqu\xe8 C++ no permet tenir dues funcions amb el mateix nom, mateixos par\xe0metres i diferent tipus de retorn."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Totes les funcions que puguin ser in-place, han de ser in-place. Les funcions que s\xf3n in-place (versi\xf3 can\xf2nica) per\xf2 que tenen una variant auxiliar que retorna un nou element, han d'acabar en ",(0,r.yg)("inlineCode",{parentName:"li"},"_new"),". Aix\xf2 aplica tant a la interf\xedcie p\xfablica com a la interf\xedcie d'implementaci\xf3."),(0,r.yg)("li",{parentName:"ul"},"Les funcions que no poden ser in-place, perqu\xe8 no modifiquen l'element, i han de retornar un valor, no cal que acabin en ",(0,r.yg)("inlineCode",{parentName:"li"},"_new"),". Per exemple, ",(0,r.yg)("inlineCode",{parentName:"li"},"length_segment")," retorna un n\xfamero, no cal que sigui ",(0,r.yg)("inlineCode",{parentName:"li"},"length_segment_new"),". El ",(0,r.yg)("inlineCode",{parentName:"li"},"_new")," \xe9s nom\xe9s un modificador per si hi ha una variant de la funci\xf3 in-place."),(0,r.yg)("li",{parentName:"ul"},"\xc9s acceptable que a la interf\xedcie p\xfablica puguin haver-hi algunes funcions amb variant tant in-place com return-new, segons necessitats, per\xf2 d'entrada no volem repetir totes les funcions in-place amb versions return-new.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-cpp"},"void rotate(IElement element, float angle);\nIElement rotate_new(IElement element, float angle);\n")),(0,r.yg)("h2",{id:"coher\xe8ncia-sem\xe0ntica-i-override-de-funcions"},"Coher\xe8ncia sem\xe0ntica i override de funcions"),(0,r.yg)("p",null,"Les funcions que s'apliquin amb els mateixos arguments a diversos elements han de tenir el mateix nom i han de tenir una funci\xf3 que faci servir el ",(0,r.yg)("inlineCode",{parentName:"p"},"VisionElement")," gen\xe8ric. Per exemple: ",(0,r.yg)("inlineCode",{parentName:"p"},"scale"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"move"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"rotate"),", etc."),(0,r.yg)("h2",{id:"no-copiar-props-autom\xe0ticament"},"No copiar props autom\xe0ticament"),(0,r.yg)("p",null,"Les funcions que modifiquen un VE i el tornen com a nou element, no copien els props de l'element original. Aix\xf2 anteriorment es feia. T\xe9 m\xe9s sentit no fer-ho en cap cas, perqu\xe8 \xe9s m\xe9s previsible el comportament."),(0,r.yg)("p",null,"Si es torna un nou element, \xe9s un nou element sense els props de l'element original. Si es vol que tingui els mateixos props es pot fer servir la funci\xf3 ",(0,r.yg)("inlineCode",{parentName:"p"},"copy_props"),". Aix\xf2 aplica tamb\xe9 a les funcions return-new."),(0,r.yg)("h2",{id:"ordre-de-les-funcions"},"Ordre de les funcions"),(0,r.yg)("p",null,"Les funcions han d'estar ordenades alfab\xe8ticament. Si les funcions dins un mateix header es poden agrupar en subgrups clarament diferenciables (segons l'element o elements al que fan refer\xe8ncia per exemple), primer s'ordenaran els subgrups alfab\xe8ticament i a continuaci\xf3 s'ordenaran les funcions de dins a cada grup."),(0,r.yg)("p",null,"Els subgrups es separen amb un comentari de la forma ",(0,r.yg)("inlineCode",{parentName:"p"},"// --- {name} ---"),". Aquest separador es far\xe0 servir tant a la definici\xf3 (",(0,r.yg)("inlineCode",{parentName:"p"},".hh"),") com a la implementaci\xf3 (",(0,r.yg)("inlineCode",{parentName:"p"},".cpp"),")."))}m.isMDXComponent=!0}}]);