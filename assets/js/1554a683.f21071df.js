"use strict";(globalThis.webpackChunk_indeepvision_idvision_docs=globalThis.webpackChunk_indeepvision_idvision_docs||[]).push([[7940],{703:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var t=r(9575),a=(r(4041),r(2247));const s={sidebar_position:2},i="Enums",o={unversionedId:"software/cpp/bones-practiques/enums",id:"software/cpp/bones-practiques/enums",title:"Enums",description:"Guardar enums en fitxers",source:"@site/docs/software/cpp/bones-practiques/enums.md",sourceDirName:"software/cpp/bones-practiques",slug:"/software/cpp/bones-practiques/enums",permalink:"/dev/docs/software/cpp/bones-practiques/enums",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"cpp",previous:{title:"Structs",permalink:"/dev/docs/software/cpp/bones-practiques/structs"},next:{title:"TODO",permalink:"/dev/docs/software/cpp/debugging/todo"}},l={},p=[{value:"Guardar enums en fitxers",id:"guardar-enums-en-fitxers",level:2},{value:"enum class",id:"enum-class",level:2},{value:"Exhaustiveness check",id:"exhaustiveness-check",level:2},{value:"Opci\xf3 <code>Invalid</code>",id:"opci\xf3-invalid",level:2},{value:"Conversi\xf3 a string",id:"conversi\xf3-a-string",level:2}],c={toc:p},u="wrapper";function d({components:e,...n}){return(0,a.yg)(u,(0,t.A)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"enums"},"Enums"),(0,a.yg)("h2",{id:"guardar-enums-en-fitxers"},"Guardar enums en fitxers"),(0,a.yg)("p",null,"Sempre guardar els enums com a ",(0,a.yg)("inlineCode",{parentName:"p"},"string"),", enlloc de guardar-los com a ",(0,a.yg)("inlineCode",{parentName:"p"},"int"),", perqu\xe8 \xe9s m\xe9s f\xe0cil d'interpretar el valor."),(0,a.yg)("h2",{id:"enum-class"},"enum class"),(0,a.yg)("p",null,"Sempre utilizar ",(0,a.yg)("inlineCode",{parentName:"p"},"enum class")," sobre ",(0,a.yg)("inlineCode",{parentName:"p"},"enum"),", perqu\xe8 els valors s\xf3n \u201cscoped\u201d, no es poden utilitzar els valors sense el context del nom de l\u2019enum. Sempre s\u2019ha de fer ",(0,a.yg)("inlineCode",{parentName:"p"},"ELogLevel::Info"),". \xc9s la forma moderna i recomanada en C++11 i posteriors."),(0,a.yg)("h2",{id:"exhaustiveness-check"},"Exhaustiveness check"),(0,a.yg)("p",null,"Els enums s\xf3n molt \xfatils perqu\xe8 el compilador pot fer un exhaustiveness check, \xe9s a dir, comprovar que s'han tractat tots els casos possibles. Si s'activa la opci\xf3 ",(0,a.yg)("inlineCode",{parentName:"p"},"/we4061")," en MSVC o ",(0,a.yg)("inlineCode",{parentName:"p"},"-Wswitch-enum")," en GCC, el compilador donar\xe0 un error si no s'han tractat tots els casos d'un enum en un switch."),(0,a.yg)("p",null,"Aquesta comprovaci\xf3 \xe9s important perqu\xe8 molts errors de programaci\xf3 es produeixen al afegir opcions a un enum (en C++) o en un literal (en TypeScript) i oblidar-se de tractar el nou cas en els switch o ifs que utilitzen aquest enum. Normalment quan aquesta modificaci\xf3 es fa temps despr\xe9s o per una persona diferent. Aquesta protecci\xf3 \xe9s molt \xfatil per detectar aquests errors tan obvis."),(0,a.yg)("p",null,"Perqu\xe8 aquests errors funcionin cal utilitzar ",(0,a.yg)("inlineCode",{parentName:"p"},"enum class")," en lloc de ",(0,a.yg)("inlineCode",{parentName:"p"},"enum"),"."),(0,a.yg)("h2",{id:"opci\xf3-invalid"},"Opci\xf3 ",(0,a.yg)("inlineCode",{parentName:"h2"},"Invalid")),(0,a.yg)("p",null,"La opci\xf3 ",(0,a.yg)("inlineCode",{parentName:"p"},"Invalid")," en un enum s'ha de fer servir sempre que faci falta la conversi\xf3 de ",(0,a.yg)("inlineCode",{parentName:"p"},"string")," a ",(0,a.yg)("inlineCode",{parentName:"p"},"enum"),", per exemple quan es llegeix un valor d'un fitxer de configuraci\xf3, on l'enum es representa com a ",(0,a.yg)("inlineCode",{parentName:"p"},"string"),"."),(0,a.yg)("p",null,"\xc9s necessari perqu\xe8 si el valor ",(0,a.yg)("inlineCode",{parentName:"p"},"string")," no \xe9s v\xe0lid, \xe9s millor no fer un throw, sin\xf3 retornar un valor ",(0,a.yg)("inlineCode",{parentName:"p"},"Invalid"),"."),(0,a.yg)("h2",{id:"conversi\xf3-a-string"},"Conversi\xf3 a string"),(0,a.yg)("p",null,"En alguns casos es fa necessari convertir els valors d'un enum a string, per exemple per a fer logging o per a mostrar missatges d'error m\xe9s descriptius."),(0,a.yg)("admonition",{type:"warning"},(0,a.yg)("p",{parentName:"admonition"},"Aquestes funcions, en general, haurien de ser ",(0,a.yg)("inlineCode",{parentName:"p"},"noexcept"),", perqu\xe8 es fan servir en contextos molt diferents (a vegades des de client) i aix\xed el seu comportament \xe9s m\xe9s previsible, m\xe9s pur.")),(0,a.yg)("p",null,"En cas necessari, utilitzar el seg\xfcent patr\xf3 per als noms:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-cpp"},'enum class ELogLevel : int32_t {\n    Invalid = -1,\n    Info = 10,\n    Warning = 11,\n}\n\nstd::string log_level_to_string(const ELogLevel level) noexcept {\n    // BUG ALERT: Use switch instead of if for better type safety (a compiler error will be raised for missing case)\n    switch (level) {\n        case ELogLevel::Info:\n            return "Info";\n        case ELogLevel::Warning:\n            return "Warning";\n        default:\n            return "Invalid";\n    }\n}\n\nELogLevel log_level_from_string(const std::string& str) noexcept {\n    if (str == "Info") {\n        return ELogLevel::Info;\n    } else if (str == "Warning") {\n        return ELogLevel::Warning;\n    } else {\n        return ELogLevel::Invalid;\n    }\n}\n')))}d.isMDXComponent=!0},2247:(e,n,r)=>{r.d(n,{xA:()=>c,yg:()=>g});var t=r(4041);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function o(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=t.createContext({}),p=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},c=function(e){var n=p(e.components);return t.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(r),m=a,g=u["".concat(l,".").concat(m)]||u[m]||d[m]||s;return r?t.createElement(g,i(i({ref:n},c),{},{components:r})):t.createElement(g,i({ref:n},c))}));function g(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=r.length,i=new Array(s);i[0]=m;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[u]="string"==typeof e?e:a,i[1]=o;for(var p=2;p<s;p++)i[p]=r[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"}}]);